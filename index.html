<!DOCTYPE html>
<html lang="en">
<head>
<style>
  img { max-width: 100%; height: auto; border-radius: 10px; }
  * { box-sizing: border-box; }
  body {
    margin: 0;
    font-family: "Segoe UI", "Georgia", serif;
    background: linear-gradient(to bottom, #cfe3f6 0%, #e9f3ff 50%, #ffffff 100%);
    color: #1e324a;
    min-height: 100vh;
  }
  header { text-align: center; padding: 60px 20px 40px 20px; }
  header h1 { font-size: 3em; background: linear-gradient(90deg, #0a558c, #69c3b3, #0a558c); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
  main { max-width: 1100px; margin: 40px auto; border-radius: 18px; padding: 45px; background: rgba(255,255,255,0.97); box-shadow: 0 4px 20px rgba(60,90,130,0.15); }
  h2 { font-size: 1.8em; color: #23476a; border-bottom: 2px solid #d6e4f7; padding-bottom: 8px; margin-top: 40px; }
  .nav-buttons { display:flex; flex-wrap:wrap; justify-content:center; margin-top:30px; gap:15px; }
  .nav-buttons button { background:#0a558c; color:white; padding:14px 22px; border-radius:12px; text-decoration:none; font-weight:bold; border:none; cursor:pointer; transition:0.3s; }
  .nav-buttons button:hover { background:#69c3b3; transform:scale(1.05); }
  .footer { text-align: center; color: #2d4764; margin: 40px auto 25px auto; font-size: 1.05em; }
  #chatButton {position:fixed;bottom:20px;right:20px;background:#0a558c;color:white;border:none;border-radius:50%;width:55px;height:55px;font-size:22px;box-shadow:0 3px 10px rgba(0,0,0,0.3);cursor:pointer;}
  #chatBox {position:fixed;bottom:80px;right:20px;width:300px;max-height:420px;background:#ffffff;border-radius:12px;box-shadow:0 3px 10px rgba(0,0,0,0.25);display:none;flex-direction:column;overflow:hidden;}
  #chatHeader {background:#0a558c;color:white;padding:10px;font-weight:bold;}
  #chatMessages {flex:1;padding:10px;overflow-y:auto;font-size:14px;}
  .msg {margin:6px 0;}
  .user {text-align:right;color:#0a558c;}
  .bot {text-align:left;color:#1e324a;}
  #chatInputArea {display:flex;border-top:1px solid #ccc;}
  #chatInput {flex:1;padding:8px;border:none;outline:none;}
  #sendBtn {background:#0a558c;color:white;border:none;padding:8px 14px;cursor:pointer;}
  #live-toast{position:fixed;bottom:24px;right:24px;background:#0a558c;color:white;padding:10px 14px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.2);display:none;z-index:2000;}
  .small-note { font-size:0.95em; color:#456; margin-top:8px; }
  .card { background:white;border-radius:12px;padding:14px;box-shadow:0 2px 10px rgba(20,40,80,0.06); margin:12px 0; }
  .flood-gallery { display:grid; grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); gap:18px; margin-top:18px; }
  .map-img { margin-top:18px; }
  .precaution-grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(240px,1fr)); gap:18px; margin-top:18px; }
  .precaution-card { background:#f8fbff; padding:12px; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.04); }
  .news-list { margin-top:18px; display:flex; flex-direction:column; gap:12px; }
  .news-item { background:#fffdf5; padding:12px; border-left:4px solid #0a558c; border-radius:8px; }
  @media (max-width:768px){main{padding:25px;}header h1{font-size:2.3em;}}
  marquee{background:#0a558c;color:white;padding:10px 0;font-weight:bold;}
</style>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>JAL SURAKSHA BY ANIKET AND NAMINSH OF MDPS ROHINI</title>
</head>
<body>
<div id="google_translate_element" style="position:fixed; top:10px; right:10px; z-index:9999;"></div>
<script type="text/javascript">
   function googleTranslateElementInit() { new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element'); }
</script>
<script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit" type="text/javascript"></script>

<div id="server-status" style="position: fixed; top: 10px; right: 10px; background: #222; color: #fff; padding: 6px 10px; border-radius: 10px; font-size: 14px; box-shadow: 0 0 10px rgba(0,0,0,0.3); z-index: 9999; opacity: 0; transition: opacity 0.5s ease;">Checking server...</div>

<header>
  <h1 style="font-size: 3.4rem; margin: 0;">Jal Suraksha</h1>
  <h4 style="font-size: 1.5rem; font-weight: normal; margin: 0;">Empowering Lives, Saving Futures</h4>
</header>

<marquee>Currently no floods in India</marquee>

<main id="mainContent">
<h2>Welcome</h2>
<p>Here you can explore all about flood and flood resilient homes (ask our Mango bot if any queries).</p>

<div class="nav-buttons">
<!-- Replaced Consequences button with JalShakti and added News button. Kept all other buttons exactly as they were. -->
<button onclick="showPage('jalshakti')">üîå JalShakti: Order</button>
<button onclick="showPage('precautions')">üõü Precautions During Flood</button>
<button onclick="showPage('plan')">üè† Flood Resistant House</button>
<button onclick="showPage('india')">üáÆüá≥ Indian Flood Updates</button>
<button onclick="showPage('help')">üìû Call for Help</button>
<button onclick="showPage('emergency')">üöë Emergency Numbers</button>
<button onclick="showPage('doctor')">ü©∫ Doctor Consultation</button>
<button onclick="showPage('live')">üì¢ Live Community Updates</button>

<!-- NEW BUTTONS ADDED (preserved from earlier) -->
<button onclick="showPage('vision')">üåÖ Our Vision (Samridh Bharat)</button>
<button onclick="showPage('data')">üìä Data & Analysis</button>
<button onclick="showPage('quiz')">üß© Flood Quiz</button>
<button onclick="showPage('scaling')">üáÆüá≥ Scaling for Bharat</button>
</div>

<div id="pageContent" style="margin-top:30px;">
<!-- Updated default home content to show multiple Indian flood pictures and a map -->
<div class="flood-gallery">
  <img alt="Vadodara Flood 2019" src="https://i.ibb.co/6RyHzVGL/Screenshot-2025-11-01-123101.png"/>
  <img alt="Assam Floods" src="https://i.ibb.co/XfnBNh48/Screenshot-2025-11-01-160021.png" />
  <img alt="Patna Floods" src="https://i.ibb.co/2DhNQ0f/image.png"/>
</div>

<div class="map-img">
  <h3>Flood-prone regions map (India)</h3>
 <div style="display: flex; justify-content: center;">
  <img 
    src="https://i.ibb.co/Vp0XKg8Q/image.png" 
    alt="India flood prone map" 
    style="width: 50%; max-width: 600px; height: auto;"
  >
</div>

  <p class="small-note">Map shows common flood-prone regions: Brahmaputra & Ganga basins, coastal areas, and some western river systems.</p>
</div>

</div>
</main>

<div class="footer" style="font-size: 20px;">¬© made by Namish Bindal &amp; Aniket Gupta, Class 8-D</div>

<!-- Chatbox (Mango) kept exactly as original -->
<button id="chatButton">üí¨</button>
<div id="chatBox">
  <div id="chatHeader">Ask Mango</div>
  <div id="chatMessages"><div class="msg bot">üëã Hi! I'm Mango ‚Äì your flood safety assistant. How can I help you today?</div></div>
  <div id="chatInputArea">
    <input accept="image/*" id="imageInput" style="display:none;" type="file"/>
    <button id="imageBtn" style="background:#69c3b3;border:none;padding:8px 10px;cursor:pointer;font-size:16px;">üì∑</button>
    <input id="chatInput" placeholder="Type your message..." type="text">
    <button id="sendBtn">Send</button>
  </div>
</div>

<!-- Firebase SDKs (kept) -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

<script>
/* ---------- Mango chat scripts (kept intact) ---------- */
const chatButton=document.getElementById('chatButton');
const chatBox=document.getElementById('chatBox');
const sendBtn=document.getElementById('sendBtn');
const chatInput=document.getElementById('chatInput');
const chatMessages=document.getElementById('chatMessages');
const imageBtn=document.getElementById('imageBtn');
const imageInput=document.getElementById('imageInput');

chatButton.onclick=()=>{chatBox.style.display=chatBox.style.display==='flex'?'none':'flex';};
imageBtn.onclick=()=>{imageInput.click();};
imageInput.onchange=(e)=>{
  const file = e.target.files[0];
  if(file && file.type.startsWith('image/')){
    appendMessage('user', 'üì∑ [Image uploaded]');
    setTimeout(()=>{ analyzeImage(file); }, 500);
  }
};

function analyzeImage(file){
  const reader = new FileReader();
  reader.onload = (e) => {
    const responses = [
      "I can see water in this image. If this is floodwater, please move to higher ground immediately and avoid contact with it. Floodwater can be contaminated and dangerous.",
      "This appears to show flooding. Make sure to:\n‚Ä¢ Stay away from moving water\n‚Ä¢ Don't walk or drive through it\n‚Ä¢ Keep emergency supplies ready\n‚Ä¢ Follow evacuation orders if issued",
      "If you're experiencing flooding:\n‚Ä¢ Move valuable items to higher floors\n‚Ä¢ Turn off electricity in affected areas\n‚Ä¢ Document damage for insurance\n‚Ä¢ Contact emergency services if needed (dial 112)",
      "I see what might be flood damage. After floods:\n‚Ä¢ Don't touch electrical equipment when wet\n‚Ä¢ Avoid drinking tap water until declared safe\n‚Ä¢ Clean and disinfect everything that got wet\n‚Ä¢ Watch for structural damage",
      "Based on this image, ensure your safety first. If you're in a flood-prone area:\n‚Ä¢ Monitor weather updates\n‚Ä¢ Have an evacuation plan\n‚Ä¢ Keep emergency kit ready\n‚Ä¢ Stay informed through official channels"
    ];
    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
    appendMessage('bot', randomResponse);
  };
  reader.readAsDataURL(file);
}

function appendMessage(sender,text){
  const div=document.createElement('div');
  div.classList.add('msg',sender);
  div.textContent=text;
  chatMessages.appendChild(div);
  chatMessages.scrollTop=chatMessages.scrollHeight;
}

let preData = {
  "greetings": [
    "Hi! How can I help with floods today?",
    "Hello! Ask me about flood safety or resilient homes."
  ],
  "thanks": [
    "You\"re welcome! Stay safe.",
    "Glad to help!"
  ],
  "resilient": "Flood-resilient homes are elevated, waterproofed, and use durable materials. Check the Resilient Homes section for details.",
  "default": "I\"m here to help with flood-related queries. Try asking about precautions, consequences, or resilient homes!",
  "hi": "Hi! How can I help with floods today?",
  "hello": "Hello! Ask me about flood safety or resilient homes.",
  "hey": "Hey there! How can I assist you about floods?",
  "thank you": "Glad to help! Stay prepared.",
  "bye": "Goodbye! Stay safe and dry.",
  "goodbye": "Goodbye! Remember to follow flood precautions!"
};

let memory = JSON.parse(localStorage.getItem("chadMemory") || "{}");
function saveMemory(){ localStorage.setItem("chadMemory", JSON.stringify(memory)); }

async function botReply(userText) {
  const lower = userText.toLowerCase();
  let reply = "In development! Data is being collected üåßÔ∏è";
  for (const [question, answer] of Object.entries(memory)) {
    if (lower.includes(question.toLowerCase())) {
      reply = answer;
      appendMessage('bot', reply);
      return;
    }
  }
  for (const [key, answer] of Object.entries(preData)) {
    if (lower.includes(key)) {
      reply = answer;
      appendMessage('bot', reply);
      return;
    }
  }
  appendMessage('bot', "ü§îü§îüí≠üí≠ Thinking...");
  try {
    const res = await fetch("https://mango-backend1-1.onrender.com/mango", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ prompt: userText })
    });
    const data = await res.json();
    reply = data.reply || "I couldn‚Äôt get an answer right now. Try again later.";
  } catch (err) {
    reply = "‚ö†Ô∏è Error contacting Mango AI. Please check your connection.";
    console.error(err);
  }
  appendMessage('bot', reply);
}

sendBtn.onclick=()=>{ const text=chatInput.value.trim(); if(!text)return; appendMessage('user',text); chatInput.value=""; setTimeout(()=>botReply(text),500); };

/* ---------- Page switching + original content preserved where possible ---------- */

function showPage(page){
  const content=document.getElementById('pageContent');
  if(!content) return;

 if(page==='precautions'){
  content.innerHTML=`
    <h2>Precautions During Flood</h2>
    <p>When floods are expected, follow these essential precautions to ensure safety.</p>

    <div class="precaution-grid">
      <div class="precaution-card">
        <h3>Move to Higher Grounds</h3>
        <p class="small-note">If water levels are rising, move to the roof or an upper floor and alert neighbors.</p>
      </div>

      <div class="precaution-card">
        <h3>Keep Emergency Kits Ready</h3>
        <p class="small-note">Include water, non-perishable food, flashlight, batteries, medicines, and important documents.</p>
      </div>

      <div class="precaution-card">
        <h3>Avoid Walking/Driving Through Floodwater</h3>
        <p class="small-note">Just 15 cm of fast-moving water can knock a person down; 30 cm can move a car.</p>
      </div>

      <div class="precaution-card">
        <h3>Unplug Electrical Devices</h3>
        <p class="small-note">Turn off the main power supply before water reaches electrical outlets. Avoid contact with electrical equipment if wet.</p>
      </div>
    </div>

    <div style="display:flex;justify-content:center;margin-top:25px;">
      <img 
        src="https://i.ibb.co/M5D8MwPp/image.png" 
        alt="Flood safety illustration" 
        style="width:50%;max-width:600px;height:auto;border-radius:12px;box-shadow:0 3px 10px rgba(0,0,0,0.15);"
      >
    </div>

    <p></p>
  `;
}
 if(page==='plan')
    content.innerHTML=`
      <h2>üè† Flood Resistant House</h2>
      <p>Flood resistant houses combine modern architecture with safety engineering, They are built to float or stand above flood levels and these designs focus on sustainability, safety, and affordability.</p>
      <ul>
        <li>üóº Elevated on sturdy and reinforced platforms</li>
        <li>ü™µ Use of waterproof materials and hydrophobic coatings</li>
        <li>üîã Solar panels and rainwater harvesting systems</li>
        <li>üåø Green surroundings that improve soil drainage</li>
      </ul>
      <div style="text-align:right;margin-top:20px;">
        <img src="https://i.postimg.cc/6QdQpYg5/flood4.jpg" alt="flood resistant house example" />
        <p style="font-size:0.9em;color:#555;margin-top:5px;">Example of elevated flood-resistant architecture</p>
      </div>`;

 if(page==='precautions'){
  content.innerHTML=`
    <h2>Precautions During Flood</h2>
    <p>When floods are expected, follow these essential precautions to ensure safety. Each item below has a matching image for quick reference:</p>

    <div class="precaution-grid">
      <div class="precaution-card">
        <h3>Move to Higher Grounds</h3>
        <p class="small-note">If water levels are rising, move to the roof or an upper floor and alert neighbors.</p>
      </div>

      <div class="precaution-card">
        <h3>Keep Emergency Kits Ready</h3>
        <p class="small-note">Include water, non-perishable food, flashlight, batteries, medicines, and important documents.</p>
      </div>

      <div class="precaution-card">
        <h3>Avoid Walking/Driving Through Floodwater</h3>
        <p class="small-note">Just 15 cm of fast-moving water can knock a person down; 30 cm can move a car.</p>
      </div>

      <!-- üëá The last box and image side by side -->
      <div class="precaution-card" style="display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;grid-column:1/-1;">
        <div style="flex:1;min-width:260px;">
          <h3>Unplug Electrical Devices</h3>
          <p class="small-note">Turn off the main power supply before water reaches electrical outlets. Avoid contact with electrical equipment if wet.</p>
        </div>
        <div style="flex:1;min-width:260px;text-align:center;">
          <img 
            src="https://i.ibb.co/M5D8MwPp/image.png" 
            alt="Flood safety illustration" 
            style="width:100%;max-width:500px;height:auto;border-radius:12px;box-shadow:0 3px 10px rgba(0,0,0,0.15);"
          >
        </div>
      </div>
    </div>
  `;

  } else if(page==='plan'){
    content.innerHTML=`
      <h2>üè† Flood Resistant House</h2>
      <p>Flood-resistant houses combine modern architecture with safety engineering. Built to float or stand above flood levels, these designs focus on sustainability, safety, and affordability.</p>
      <ul>
        <li>üóº Elevated on sturdy and reinforced platforms</li>
        <li>ü™µ Use of waterproof materials and hydrophobic coatings</li>
        <li>üîã Solar panels and rainwater harvesting systems</li>
        <li>üåø Green surroundings that improve soil drainage</li>
      </ul>
      <div style="text-align:right;margin-top:20px;">
        <img src="https://i.postimg.cc/6QdQpYg5/flood4.jpg" alt="flood resistant house example" />
        <p style="font-size:0.9em;color:#555;margin-top:5px;">Example of elevated flood-resistant architecture</p>
      </div>`;
  }

else if(page==='india'){
    content.innerHTML = `
      <h2>üáÆüá≥ Recent Indian Flood Updates (2025)</h2>
      <p>In September 2025, severe flooding and landslides affected several northern Indian states, including Punjab, Jammu and Kashmir, Uttarakhand, Delhi, and Himachal Pradesh, following prolonged and intense rainfall. Stay updated through official government channels, NDRF alerts, and local disaster management authorities for real-time information.</p>
      <div class="card">
        <strong>Key trends:</strong>
        <ul>
          <li> <b>Punjab experienced its worst floods in recent history, with 30 fatalities reported and over 354,000 people affected across all 23 districts, which were declared flood-hit</b></li>
          <li>In Jammu and Kashmir, <b>more than 50 people died in the past fortnight due to heavy rains and flash floods</b>, with the Jammu-Srinagar National Highway closed for eight consecutive days due to landslides and road washouts</li>
          <li><b>Delhi and the National Capital Region (NCR) also faced severe waterlogging, with the Yamuna River breaching its danger mark and floodwaters entering homes.
 Schools and offices in multiple regions, including Gurugram, Chandigarh, and Uttar Pradesh, were closed, and traffic congestion worsened due to flooded roads</b></li>
        </ul>
      </div>
      <p class="small-note">The content here is for demo purposes. For live alerts, use official NDRF/IMD channels.<br><strong>Small Update:latest news has been added from google as of september 2025</strong></p>
    `;
  }

else if(page==='help'){
    content.innerHTML = `
      <h2>üìû Call for Help</h2>
      <p>If you are in an emergency situation during floods, please fill in your details below. Our system will alert the nearest rescue services.<strong>!DO NOT TAKE SERIOUSLY WE DO NOT HAVE ANY TEAM!</strong></p>
      <div style="margin-top:20px;padding:20px;background:#f0f7ff;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.1);">
        <label for="helpName" style="font-weight:bold;color:#0a558c;">Your Name:</label><br>
        <input id="helpName" type="text" placeholder="Enter your name" style="width:100%;padding:10px;margin:8px 0;border:1px solid #ccc;border-radius:6px;"><br>
        <label for="helpAddress" style="font-weight:bold;color:#0a558c;">Your Address / Location:</label><br>
        <input id="helpAddress" type="text" placeholder="Enter your full address" style="width:100%;padding:10px;margin:8px 0;border:1px solid #ccc;border-radius:6px;"><br>
        <label for="helpProblem" style="font-weight:bold;color:#0a558c;">Describe the Problem:</label><br>
        <textarea id="helpProblem" placeholder="Describe what kind of help you need..." style="width:100%;height:80px;padding:10px;margin:8px 0;border:1px solid #ccc;border-radius:6px;"></textarea><br>
        <button id="callHelpBtn" style="background:#dc3545;color:white;border:none;padding:12px 18px;border-radius:8px;font-weight:bold;cursor:pointer;">üö® Call</button>
      </div>
      <p id="helpMessage" style="margin-top:20px;font-size:1.2em;color:#088a0b;font-weight:bold;display:none;">üöë Help is on the way!</p>
    `;
    setTimeout(()=> {
      const callBtn = document.getElementById('callHelpBtn');
      if(callBtn){
        callBtn.onclick = () => {
          const name = document.getElementById('helpName').value.trim();
          const address = document.getElementById('helpAddress').value.trim();
          const problem = document.getElementById('helpProblem').value.trim();
          if (!name || !address || !problem) {
            alert('‚ö†Ô∏è Please fill in all fields before calling for help.');
            return;
          }
          document.getElementById('helpMessage').style.display = 'block';
          alert('üì° Your request has been sent. Rescue services have been notified.');
        };
      }
    }, 150);
  } else if(page==='emergency'){
    content.innerHTML = `
      <h2>üöë Emergency Numbers</h2>
      <p>If you or someone near you is in danger or needs urgent medical, rescue, or disaster help, use the official helpline numbers below:</p>
      <h3>üìû National Emergency Services</h3>
      <ul>
        <li><strong>Disaster Management Helpline:</strong> <a href="tel:1078" style="color:#0a558c;text-decoration:none;">1078</a></li>
        <li><strong>National Emergency Number:</strong> <a href="tel:112" style="color:#0a558c;text-decoration:none;">112</a></li>
        <li><strong>Ambulance Service:</strong> <a href="tel:108" style="color:#0a558c;text-decoration:none;">108</a></li>
        <li><strong>Police Helpline:</strong> <a href="tel:100" style="color:#0a558c;text-decoration:none;">100</a></li>
        <li><strong>Fire Department:</strong> <a href="tel:101" style="color:#0a558c;text-decoration:none;">101</a></li>
      </ul>
      <h3>üèõÔ∏è National Disaster Agencies</h3>
      <ul>
        <li><a href="https://www.ndrf.gov.in" target="_blank" rel="noopener noreferrer" style="color:#0a558c;text-decoration:none;">National Disaster Response Force (NDRF)</a></li>
        <li><a href="https://ndma.gov.in" target="_blank" rel="noopener noreferrer" style="color:#0a558c;text-decoration:none;">National Disaster Management Authority (NDMA)</a></li>
        <li><a href="https://www.nidm.gov.in" target="_blank" rel="noopener noreferrer" style="color:#0a558c;text-decoration:none;">National Institute of Disaster Management (NIDM)</a></li>
      </ul>
      <h3>‚ù§Ô∏è Trusted NGOs & Relief Organizations</h3>
      <ul>
        <li><a href="https://www.redcross.org.in" target="_blank" rel="noopener noreferrer" style="color:#0a558c;text-decoration:none;">Indian Red Cross Society</a></li>
        <li><a href="https://goonj.org" target="_blank" rel="noopener noreferrer" style="color:#0a558c;text-decoration:none;">Goonj Relief Network</a></li>
        <li><a href="https://aidindia.org" target="_blank" rel="noopener noreferrer" style="color:#0a558c;text-decoration:none;">AID India Flood Support</a></li>
        <li><a href="https://www.pmcares.gov.in" target="_blank" rel="noopener noreferrer" style="color:#0a558c;text-decoration:none;">PM CARES Fund</a></li>
      </ul>
      <p style="margin-top:20px;font-style:italic;color:#555;">üí° Save these numbers on your phone before a flood emergency occurs.</p>
    `;
  } else if(page==='doctor'){
    content.innerHTML = `
      <h2>ü©∫ Doctor Consultation</h2>
      <p>If you're feeling unwell during or after floods, consult a certified general physician instantly for medical guidance.</p>
      <div style="margin-top:20px;padding:20px;background:#f0f7ff;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.1);text-align:center;">
        <p style="font-size:1.1em;color:#0a558c;font-weight:bold;">Connect with a doctor now:<br>for anyone whose call now button is not working type manually -->(+91) 1080888000</p>
        <a href="tel:+911080888000" style="display:inline-block;background:#0a558c;color:white;text-decoration:none;padding:12px 20px;border-radius:10px;font-weight:bold;font-size:1.1em;">üìû Call Now</a>
        <p style="margin-top:12px;font-size:0.9em;color:#555;">Available 24/7 through Apollo Hospitals helpline.</p>
      </div>
    `;
  } else if(page==='live' || page==='liveupdates' || page==='live-updates'){
    // open live updates - preserved Firebase usage
    content.innerHTML = `
      <h2>üì¢ Live Community Updates</h2>
      <p>Share real-time updates ‚Äî flood level, help available, road closures, or safe spots. Posts are shared across all users.</p>
      <div style="margin:20px 0;padding:20px;background:#f0f7ff;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.06);">
        <input id="updateName" type="text" placeholder="Your Name (optional)" style="width:100%;padding:10px;margin-bottom:10px;border-radius:6px;border:1px solid #ccc;">
        <input id="updateLocation" type="text" placeholder="Location (e.g., Patna, Bihar)" style="width:100%;padding:10px;margin-bottom:10px;border-radius:6px;border:1px solid #ccc;">
        <textarea id="updateMessage" placeholder="Write your update here..." style="width:100%;height:80px;padding:10px;border-radius:6px;border:1px solid #ccc;"></textarea>
        <div style="display:flex;gap:10px;margin-top:10px;">
          <button id="postUpdateBtn" style="background:#0a558c;color:white;border:none;padding:10px 16px;border-radius:8px;cursor:pointer;">Post Update</button>
          <button id="refreshUpdatesBtn" style="background:#69c3b3;color:white;border:none;padding:10px 16px;border-radius:8px;cursor:pointer;">Refresh</button>
        
        </div>
        <div id="offerHelpFields" style="display:none;margin-top:10px;">
          <input id="offerType" type="text" placeholder="What can you offer? (boat / food / shelter)" style="width:100%;padding:10px;margin-top:8px;border-radius:6px;border:1px solid #ccc;">
          <input id="offerContact" type="text" placeholder="Contact number / Telegram / WhatsApp" style="width:100%;padding:10px;margin-top:8px;border-radius:6px;border:1px solid #ccc;">
        </div>
      </div>
      <div id="updatesList" style="margin-top:25px;"></div>
    `;
    // wire up after short delay to allow DOM
    setTimeout(()=> {
      document.getElementById('postUpdateBtn').onclick = postUpdateToFirebase;
      document.getElementById('refreshUpdatesBtn').onclick = ()=> db.ref('updates').once('value').then(renderUpdates);
      document.getElementById('offerHelpToggle').onclick = ()=>{
        const f = document.getElementById('offerHelpFields');
        if(f.style.display==='none') f.style.display='block'; else f.style.display='none';
      };
      db.ref('updates').once('value').then(renderUpdates);
    }, 200);
  }

  /* ---------- NEW PAGES: Vision, Data, Innovation, Quiz, Scaling, JalShakti,---------- */

  else if(page==='vision'){
    content.innerHTML = `
      <h2>üåÖ Vision ‚Äî Samridh Bharat: Flood-Resilient Communities</h2>
      <p>We want to make India's flood-prone areas stronger by creating inexpensive flood-resistant homes, getting communities ready, and building up local skills. This supports sustainable livelihoods, reduces disaster costs, and protects vulnerable families.</p>
      <div class="card">
        <strong>How this contributes to Samridh Bharat:</strong>
        <ul>
          <li>Reduces displacement and livelihood loss</li>
          <li>Supports resilient agriculture and local markets</li>
          <li>Creates jobs via local construction & materials</li>
          <li>Aligns with UN SDGs ‚Äî sustainable cities and climate action</li>
        </ul>
      </div>
    `;
  } else if(page==='data'){
    content.innerHTML = `
      <h2>üìä Data & Analysis</h2>
      <p>Below are sample visualisations to demonstrate how data can guide flood planning. (Mock/demo data.)</p>
      <div class="card">
        <canvas id="rainChart" width="400" height="220"></canvas>
        <p class="small-note">Rainfall trend (mock): average monthly rainfall across a flood-prone region.</p>
      </div>
      <div class="card">
        <canvas id="stateChart" width="400" height="220"></canvas>
        <p class="small-note">Top 5 affected states by incidents (mock data).</p>
      </div>
    `;
    setTimeout(()=>{ renderCharts(); }, 250);
   } else if(page==='quiz'){
    content.innerHTML = `
      <h2>üß© Flood Awareness Quiz</h2>
      <p>Test your knowledge ‚Äî 5 quick questions. Get a shareable result at the end.</p>
      <div class="card" id="quizCard">
        <div id="quizQuestion"></div>
        <div id="quizOptions" style="margin-top:12px;"></div>
        <div style="margin-top:12px;">
          <button id="nextQ" style="background:#0a558c;color:white;border:none;padding:8px 12px;border-radius:8px;cursor:pointer;">Next</button>
        </div>
        <div id="quizResult" style="display:none;margin-top:12px;"></div>
      </div>
    `;
    setTimeout(()=>{ startQuiz(); }, 200);
  } else if(page==='scaling'){
    content.innerHTML = `
      <h2>üáÆüá≥ Scaling Flood-Resilient Homes for Bharat</h2>
      <p>This section outlines a practical plan to scale the JalShakti model across flood-prone regions,"<strong>YOU CAN ORDER THE JalShakti MODEL FROM THE JalShakti:order PAGE AT THE START</strong>"</p>
      <div class="card">
        <strong>Key elements:</strong>
        <ul>
          <li>Prototype cost estimate: <strong>demo</strong> ‚Äî> ‚Çπ1.5‚Äì2.5 thousand per unit (modular)</li>
          <li>Partnerships: Local masons, NGOs, state disaster authorities, PM Awas Yojana integration<strong>(demo do not take seriously we have not partnered with any of them.)</strong></li>
          <li>Financing: blended public grants + microfinance for households</li>
          <li>Training: community build workshops & maintenance manuals</li>
        </ul>
      </div>
      
    `;
  } else if(page==='jalshakti'){
    content.innerHTML = `
      <h2>üîã JalShakti: Order your JalShakti today</h2>
      <p>JalShakti is a prototype micro-hydro generator device that uses the motion of floodwater and small streams to produce emergency electricity for essential and daily tasks during a flood.</p>
      <div style="display:flex;gap:20px;flex-wrap:wrap;margin-top:18px;">
        <div style="flex:1;min-width:260px;">
          <img src="https://i.ibb.co/LD6D723Y/image.png" alt="JalShakti Prototype" style="border-radius:10px;"/>
        </div>
        <div style="flex:1;min-width:260px;">
          <h3>Key features</h3>
          <ul>
         
            <li><u>It is portable and modular and is also easy to deploy in flooded areas</u></li>
            <li><u>It also produces enough power for lights, charging phones and running small lamps</u></li>
            <li><u>It can charge phones,power banks and stoves for cooking food</u></li>
            <li><u>Easy and simple maintainance ,Local parts are also used</u></li>
          </ul>
         <p style="margin-top:16px; font-size:18px;">
  <strong>Order prototype:</strong>
  <button 
    onclick="alert('Thanks! We have received your order request. Please wait for some time.')"
    style="background:#0a558c; 
           color:white; 
           border:none; 
           padding:14px 20px; 
           border-radius:10px; 
           cursor:pointer; 
           font-size:18px;">
    Order JalShakti
  </button>
</p>

        </div>
      </div>
      <p class="small-note" style="margin-top:12px;"><strong>(This is a prototype listing for demo purposes.)</strong></p>
    `;

  } else {
    // default welcome content (kept updated with gallery & map)
    content.innerHTML = `
      <div class="flood-resistant houses">
        <img alt="Vadodara Flood 2019" src="https://i.ibb.co/6RyHzVGL/Screenshot-2025-11-01-123101.png"/>
      
      </div>
      <div class="map-img">
      
    `;
  }
}

/* ---------- Firebase config + Live updates rendering (kept + small improvement) ---------- */

const firebaseConfig = {
  apiKey: "AIzaSyB8W9WDY8Qmx3BzuQwB7p459ph0fiYx-Bs",
  authDomain: "flood-updates.firebaseapp.com",
  databaseURL: "https://flood-updates-default-rtdb.firebaseio.com",
  projectId: "flood-updates",
  storageBucket: "flood-updates.firebasestorage.app",
  messagingSenderId: "563898722183",
  appId: "1:563898722183:web:9031fad54e8e9b487b1522",
  measurementId: "G-JXLY9VFWHY"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

function getClientId(){
  let id = localStorage.getItem('flood_client_id');
  if(!id){
    id = 'c_' + Math.random().toString(36).substring(2,10) + Date.now().toString(36);
    localStorage.setItem('flood_client_id', id);
  }
  return id;
}
const CLIENT_ID = getClientId();

function showToast(msg,ms=2000){
  let t = document.getElementById('live-toast');
  if(!t){ t = document.createElement('div'); t.id='live-toast'; document.body.appendChild(t); }
  t.textContent = msg; t.style.display = 'block'; setTimeout(()=>{ t.style.opacity='1'; },10);
  setTimeout(()=>{ t.style.display='none'; },ms);
}

function renderUpdates(snapshot){
  const data = snapshot.val() || {};
  const arr = Object.keys(data).map(k=>({ key:k, ...data[k] }));
  arr.sort((a,b)=> (b.timestamp||0) - (a.timestamp||0));
  const container = document.getElementById('updatesList');
  if(!container) return;
  if(arr.length===0){ container.innerHTML = '<p style="text-align:center;color:#666;padding:20px;">No updates yet. Be the first to share!</p>'; return; }
  container.innerHTML = arr.map(u=>{
    const own = u.clientId === CLIENT_ID;
    return `
      <div style="background:white;border-left:4px solid #0a558c;padding:15px;margin:15px 0;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.08);">
        <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:10px;">
          <div style="flex:1;">
            <strong style="color:#0a558c;font-size:1.1em;">üìç ${escapeHtml(u.location||'Unknown')}</strong>
            <div style="font-size:0.85em;color:#666;margin-top:3px;">Posted by <strong>${escapeHtml(u.name||'Anonymous')}</strong> ‚Ä¢ ${new Date(u.timestamp||0).toLocaleString('en-IN',{timeZone:'Asia/Kolkata', dateStyle:'medium', timeStyle:'short'})}</div>
          </div>
          ${ own ? `<button data-key="${u.key}" class="delete-btn" style="background:#dc3545;color:white;border:none;padding:5px 10px;border-radius:5px;cursor:pointer;font-size:0.85em;">Delete</button>` : '' }
        </div>
        <p style="margin:10px 0 0 0;color:#333;line-height:1.6;">${escapeHtml(u.message||'')}</p>
        ${ own ? `<div style="margin-top:8px;font-size:0.85em;color:#088a0b;">üü¢ Posted by you</div>` : '' }
      </div>
    `;
  }).join('');
  container.querySelectorAll('.delete-btn').forEach(btn=>{
    btn.onclick = ()=> {
      const key = btn.getAttribute('data-key');
      if(!confirm('Delete this update?')) return;
      db.ref('updates/' + key).once('value').then(s=>{
        const obj = s.val();
        if(obj && obj.clientId === CLIENT_ID){
          db.ref('updates/' + key).remove();
        } else {
          alert("You can only delete your own posts.");
        }
      });
    };
  });
}

function escapeHtml(s){ if(!s) return ''; return s.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;').replaceAll("'",'&#39;'); }

function openLiveUpdates(){ showPage('live'); }

// post to firebase
function postUpdateToFirebase(){
  const name = (document.getElementById('updateName')?.value || '').trim() || 'Anonymous';
  const location = (document.getElementById('updateLocation')?.value || '').trim();
  const message = (document.getElementById('updateMessage')?.value || '').trim();
  const offer = (document.getElementById('offerType')?.value || '').trim();
  const contact = (document.getElementById('offerContact')?.value || '').trim();
  let fullMessage = message;
  if(offer) fullMessage += `\nOffer: ${offer} ‚Ä¢ Contact: ${contact || 'N/A'}`;
  if(!location || !message){ alert('Please fill location and message'); return; }
  const newRef = db.ref('updates').push();
  const payload = { clientId: CLIENT_ID, name, location, message: fullMessage, timestamp: Date.now() };
  newRef.set(payload).then(()=>{ document.getElementById('updateName').value=''; document.getElementById('updateLocation').value=''; document.getElementById('updateMessage').value=''; document.getElementById('offerType').value=''; document.getElementById('offerContact').value=''; showToast('‚úÖ Update posted successfully!',2000); }).catch(err=>{ alert('Failed to post update: ' + err.message); });
}

db.ref('updates').on('value', function(snapshot){
  const content = document.getElementById('pageContent');
  if (content && content.querySelector('#updatesList')) { renderUpdates(snapshot); }
});

// initial button binding
document.addEventListener('DOMContentLoaded', function(){
  const btn = document.querySelector('[onclick*=\"live\"]');
  if(btn){ btn.onclick = openLiveUpdates; }
});

/* ---------- Server status check (kept) ---------- */

async function checkServerStatus() {
  const statusDiv = document.getElementById("server-status");
  const backendURL = "https://mango-backend1-1.onrender.com/";
  try {
    const res = await fetch(backendURL, { method: "GET" });
    if (res.ok) {
      statusDiv.textContent = "üü¢ Online";
      statusDiv.style.background = "#007a1e";
      statusDiv.style.opacity = "1";
    } else {
      statusDiv.textContent = "üî¥ Offline";
      statusDiv.style.background = "#a30000";
      statusDiv.style.opacity = "1";
    }
  } catch (err) {
    statusDiv.textContent = "üî¥ Offline";
    statusDiv.style.background = "#a30000";
    statusDiv.style.opacity = "1";
  }
}
checkServerStatus();
setInterval(checkServerStatus, 60000);

/* ---------- Charts (Chart.js via CDN) ---------- */

function renderCharts(){
  // load Chart.js if not already
  if(typeof Chart === 'undefined'){
    const s = document.createElement('script'); s.src = "https://cdn.jsdelivr.net/npm/chart.js"; s.onload = renderCharts; document.head.appendChild(s); return;
  }
  // mock data for rainfall
  const ctx = document.getElementById('rainChart').getContext('2d');
  const rainChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],
      datasets: [{ label: 'Avg monthly rainfall (mm)', data: [12,18,32,48,120,210,300,280,150,60,20,8], tension:0.3 }]
    },
    options: { responsive:true, plugins:{legend:{display:true}} }
  });

  // mock data for states
  const ctx2 = document.getElementById('stateChart').getContext('2d');
  const stateChart = new Chart(ctx2, {
    type: 'bar',
    data: {
      labels: ['Assam','Bihar','Punjab','Uttarakhand','West Bengal'],
      datasets: [{ label: 'Incidents (mock)', data: [120,95,80,45,70] }]
    },
    options: { responsive:true, plugins:{legend:{display:false}} }
  });
}

/* ---------- Quiz logic ---------- */

const QUIZ_QUESTIONS = [
  {q: "What's the safest action during fast-moving flood water?", options:["Try to swim across","Move to higher ground","Drive slowly through it","Wait at the same spot"], a:1},
  {q: "What should NOT be used after flood water settles down?", options:["Use boiled water","Eat canned food","Use wet electrical appliances","Dry and disinfect belongings"], a:2},
  {q: "Which local resource helps absorb excess water and reduce flooding?", options:["Concrete pavement","Bioswales and wetlands","More parking lots","Paved canals"], a:1},
  {q: "A good emergency kit should include:", options:["Batteries, torch, water, first-aid","Only money","Heavy furniture","Gas stove with open flame"], a:0},
  {q: "Who should you contact for immediate rescue in India?", options:["112","1000","9999","5555"], a:0}
];

function startQuiz(){
  let idx = 0; let score = 0;
  const qEl = document.getElementById('quizQuestion'); const oEl = document.getElementById('quizOptions'); const nextBtn = document.getElementById('nextQ'); const resEl = document.getElementById('quizResult');
  function render(){
    resEl.style.display='none';
    qEl.innerHTML = `<h3>Q${idx+1}. ${QUIZ_QUESTIONS[idx].q}</h3>`;
    oEl.innerHTML = QUIZ_QUESTIONS[idx].options.map((opt,i)=>`<div style="margin:6px 0;"><label style="display:block;padding:8px;border:1px solid #ccc;border-radius:8px;cursor:pointer;"><input type="radio" name="opt" value="${i}"> ${opt}</label></div>`).join('');
    nextBtn.textContent = idx === QUIZ_QUESTIONS.length-1 ? 'Finish' : 'Next';
  }
  render();
  nextBtn.onclick = ()=>{
    const sel = document.querySelector('input[name="opt"]:checked');
    if(!sel){ alert('Please select an option'); return; }
    const val = parseInt(sel.value,10);
    if(val === QUIZ_QUESTIONS[idx].a) score++;
    idx++;
    if(idx < QUIZ_QUESTIONS.length){ render(); } else {
      qEl.innerHTML = ''; oEl.innerHTML = ''; nextBtn.style.display='none';
      resEl.style.display='block';
      resEl.innerHTML = `<h3>Your Score: ${score} / ${QUIZ_QUESTIONS.length}</h3><p class="small-note">Share your result with friends to spread awareness!</p><button id="shareQuiz" style="background:#69c3b3;color:white;border:none;padding:8px 12px;border-radius:8px;cursor:pointer;">Share</button>`;
      document.getElementById('shareQuiz').onclick = ()=> {
        const text = `I scored ${score}/${QUIZ_QUESTIONS.length} on the Flood Awareness Quiz! Learn more at FHR project.`;
        if(navigator.share){ navigator.share({title:'Flood Quiz Result', text}); }
        else { prompt('Copy and share:', text); }
      };
    }
  };
}

/* ---------- Small helpers ---------- */

document.addEventListener('click', (e)=>{
  if(e.target && e.target.id === 'trainBtn'){
    const q=document.getElementById('trainQ').value.trim(); const a=document.getElementById('trainA').value.trim();
    if(!q||!a) return alert("Please fill both fields.");
    memory[q]=a; saveMemory(); alert(`‚úÖ mango learned: \"${q}\"`); document.getElementById('trainQ').value=''; document.getElementById('trainA').value='';
  }
});
</script>

</body>
</html>
